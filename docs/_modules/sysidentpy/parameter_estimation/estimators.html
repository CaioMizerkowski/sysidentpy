


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sysidentpy.parameter_estimation.estimators &mdash; SysIdentPy</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../_static/jquery.fancybox.min.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../_static/glpi.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="SysIdentPy" href="../../../index.html"/>
        <link rel="up" title="Module code" href="../../index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> sysidentpy
          

          
          </a>

          
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Install Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction_to_narmax.html">A brief introduction to NARMAX models.</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev_guide.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks.html">Jupyter notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html">Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.base">sysidentpy base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#sysidentpy-main">sysidentpy main</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.residues.residues_correlation">sysidentpy residues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.metrics._regression">sysidentpy metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.parameter_estimation.estimators">sysidentpy estimators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.utils._check_arrays">sysidentpy utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#module-sysidentpy.utils.generate_data">sysidentpy generate data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../code.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">sysidentpy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>sysidentpy.parameter_estimation.estimators</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sysidentpy.parameter_estimation.estimators</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; Least Squares Methodos for parameter estimation &quot;&quot;&quot;</span>

<span class="c1"># Authors:</span>
<span class="c1">#           Wilson Rocha Lacerda Junior &lt;wilsonrljr@outlook.com&gt;</span>
<span class="c1"># License: BSD 3 clause</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># from ..base import InformationMatrix</span>


<div class="viewcode-block" id="Estimators"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators">[docs]</a><span class="k">class</span> <span class="nc">Estimators</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Oridanry Least squares for linear parameter estimation&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_lag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.98</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                 <span class="n">offset_covariance</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                 <span class="n">eps</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span><span class="p">,</span>
                 <span class="n">gama</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_eps</span> <span class="o">=</span> <span class="n">eps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span> <span class="o">=</span> <span class="n">mu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_offset_covariance</span> <span class="o">=</span> <span class="n">offset_covariance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aux_lag</span> <span class="o">=</span> <span class="n">aux_lag</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lam</span> <span class="o">=</span> <span class="n">lam</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span> <span class="o">=</span> <span class="n">delta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_gama</span> <span class="o">=</span> <span class="n">gama</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_weight</span> <span class="o">=</span> <span class="n">weight</span>  <span class="c1"># &lt;0  e &lt;1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_params</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Validate input params.&quot;&quot;&quot;</span>
        <span class="n">attributes</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;aux_lag&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aux_lag</span><span class="p">,</span>
                      <span class="s1">&#39;lam&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lam</span><span class="p">,</span>
                      <span class="s1">&#39;delta&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_delta</span><span class="p">,</span>
                      <span class="s1">&#39;offset_covariance&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset_covariance</span><span class="p">,</span>
                      <span class="s1">&#39;mu&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="p">,</span>
                      <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="p">,</span>
                      <span class="s1">&#39;gama&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gama</span><span class="p">,</span>
                      <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_weight</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> must be int or float (positive).&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lam&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">,</span> <span class="s1">&#39;offset_covariance&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> must lies on [0 1] range. Got </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2"> must be positive. Got </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;Check the documentation for allowed values&quot;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_check_linear_dependence_rows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span> <span class="o">!=</span> <span class="n">psi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">((</span><span class="s2">&quot;Psi matrix might have linearly dependent rows.&quot;</span>
                          <span class="s2">&quot;Be careful and check your data&quot;</span><span class="p">),</span>
                          <span class="n">stacklevel</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<div class="viewcode-block" id="Estimators.least_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_squares">[docs]</a>    <span class="k">def</span> <span class="nf">least_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the model parameters using Least Squares method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Manuscript: Sorenson, H. W. (1970). Least-squares estimation:</span>
<span class="sd">            from Gauss to Kalman. IEEE spectrum, 7(7), 63-68.</span>
<span class="sd">            &lt;http://pzs.dstu.dp.ua/DataMining/mls/bibl/Gauss2Kalman.pdf&gt;`_</span>
<span class="sd">        [2]`Book (Portuguese): Aguirre, L. A. (2007). Introduçaoa identificaçao</span>
<span class="sd">            de sistemas: técnicas lineares enao-lineares aplicadas a sistemas</span>
<span class="sd">            reais. Editora da UFMG. 3a ediçao.</span>
<span class="sd">            &lt;https://books.google.com.br/books?hl=pt-BR&amp;lr=&amp;id=f9IwE7Ph0fYC&amp;oi=fnd&amp;pg=PA2&amp;dq=Introdu%C3%A7%C3%A3o+%C3%A0+identifica%C3%A7%C3%A3o+de+sistemas+-+T%C3%A9cnicas+lineares+e+n%C3%A3o-lineares+aplicadas+a+sistemas+reais&amp;ots=Qiyc4VsMdt&amp;sig=6gumj1AEWh_b0tUGR4quI5oETUA#v=onepage&amp;q=Introdu%C3%A7%C3%A3o%20%C3%A0%20identifica%C3%A7%C3%A3o%20de%20sistemas%20-%20T%C3%A9cnicas%20lineares%20e%20n%C3%A3o-lineares%20aplicadas%20a%20sistemas%20reais&amp;f=false&gt;`_</span>
<span class="sd">        [3]`Manuscript: Markovsky, I., &amp; Van Huffel, S. (2007).</span>
<span class="sd">            Overview of total least-squares methods.</span>
<span class="sd">            Signal processing, 87(10), 2283-2302.</span>
<span class="sd">            &lt;https://eprints.soton.ac.uk/263855/1/tls_overview.pdf&gt;`_</span>
<span class="sd">        [4]`Wikipedia entry on Least Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_squares&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_linear_dependence_rows</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_aux_lag</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi</span><span class="p">))</span><span class="nd">@psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@y</span>
        <span class="k">return</span> <span class="n">theta</span></div>

<div class="viewcode-block" id="Estimators.total_least_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.total_least_squares">[docs]</a>    <span class="k">def</span> <span class="nf">total_least_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the model parameters using Total Least Squares method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Manuscript: Golub, G. H., &amp; Van Loan, C. F. (1980).</span>
<span class="sd">            An analysis of the total least squares problem.</span>
<span class="sd">            SIAM journal on numerical analysis, 17(6), 883-893.</span>
<span class="sd">            &lt;https://epubs.siam.org/doi/pdf/10.1137/0717073?casa_token=218O16LygKkAAAAA:GyssnBnNEWzVg2Wvbmu5K1pj-XwkzpTSknUsddVTZfEJafpKANUstMuRDyJjIdcTgO-tFuQYb4Y&gt;`_</span>
<span class="sd">        [2]`Manuscript: Markovsky, I., &amp; Van Huffel, S. (2007).</span>
<span class="sd">            Overview of total least-squares methods.</span>
<span class="sd">            Signal processing, 87(10), 2283-2302.</span>
<span class="sd">            &lt;https://eprints.soton.ac.uk/263855/1/tls_overview.pdf&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Total Least Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Total_least_squares&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_aux_lag</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">full</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">[:</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">:]</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">n</span><span class="p">:,</span> <span class="n">n</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">theta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_initial_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_aux_lag</span><span class="p">:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n_theta</span> <span class="o">=</span> <span class="n">psi</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">psi</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">xi</span>

<div class="viewcode-block" id="Estimators.recursive_least_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.recursive_least_squares">[docs]</a>    <span class="k">def</span> <span class="nf">recursive_least_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the model parameters using the Recursive Least Squares method.</span>

<span class="sd">        The implementation consider the forgeting factor.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book (Portuguese): Aguirre, L. A. (2007). Introduçaoa identificaçao</span>
<span class="sd">            de sistemas: técnicas lineares enao-lineares aplicadas a sistemas</span>
<span class="sd">            reais. Editora da UFMG. 3a ediçao.</span>
<span class="sd">            &lt;https://books.google.com.br/books?hl=pt-BR&amp;lr=&amp;id=f9IwE7Ph0fYC&amp;oi=fnd&amp;pg=PA2&amp;dq=Introdu%C3%A7%C3%A3o+%C3%A0+identifica%C3%A7%C3%A3o+de+sistemas+-+T%C3%A9cnicas+lineares+e+n%C3%A3o-lineares+aplicadas+a+sistemas+reais&amp;ots=Qiyc4VsMdt&amp;sig=6gumj1AEWh_b0tUGR4quI5oETUA#v=onepage&amp;q=Introdu%C3%A7%C3%A3o%20%C3%A0%20identifica%C3%A7%C3%A3o%20de%20sistemas%20-%20T%C3%A9cnicas%20lineares%20e%20n%C3%A3o-lineares%20aplicadas%20a%20sistemas%20reais&amp;f=false&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_theta</span><span class="p">)</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">_delta</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">k_numerator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lam</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">p</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">)</span>
            <span class="n">k_denominator</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_lam</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">)</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">k_numerator</span><span class="p">,</span> <span class="n">k_denominator</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="n">k</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>

            <span class="n">p1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>\
                <span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="n">p2</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>\
                <span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lam</span>

            <span class="n">p_numerator</span> <span class="o">=</span> <span class="n">p</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">p_numerator</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lam</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">theta_evolution</span> <span class="o">=</span> <span class="n">theta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.affine_least_mean_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.affine_least_mean_squares">[docs]</a>    <span class="k">def</span> <span class="nf">affine_least_mean_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the model parameters using the Affine Least Mean Squares.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Poularikas, A. D. (2017). Adaptive filtering: Fundamentals</span>
<span class="sd">            of least mean squares with MATLAB®. CRC Press.</span>
<span class="sd">            &lt;https://books.google.com.br/books?hl=pt-BR&amp;lr=&amp;id=OJPSBQAAQBAJ&amp;oi=fnd&amp;pg=PP1&amp;dq=adaptive+filtering+fundamentals+of+least+mean+squares+with+matlab&amp;ots=dMNzB_2erC&amp;sig=7l0VvIm9-GwUDgj0xuy1m0c0Gdo#v=onepage&amp;q=adaptive%20filtering%20fundamentals%20of%20least%20mean%20squares%20with%20matlab&amp;f=false&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">psi</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="n">psi</span><span class="nd">@np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi</span>
                                              <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_offset_covariance</span>
                                              <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_theta</span><span class="p">))</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="n">aux</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Estimate the model parameters using the Least Mean Squares filter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Haykin, S., &amp; Widrow, B. (Eds.). (2003). Least-mean-square</span>
<span class="sd">            adaptive filters (Vol. 31). John Wiley &amp; Sons.</span>
<span class="sd">            &lt;https://books.google.com.br/books?hl=pt-BR&amp;lr=&amp;id=U8X3mJtawUkC&amp;oi=fnd&amp;pg=PR9&amp;dq=%22least+mean+square%22&amp;ots=Bzp42ZklVe&amp;sig=ZilhP9bYuuagpi30hrJk53sWj_8&amp;redir_esc=y#v=onepage&amp;q=%22least%20mean%20square%22&amp;f=false&gt;`_</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="n">psi_tmp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_sign_error"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_sign_error">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_sign_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Sign-Error  Least Mean Squares filter.</span>

<span class="sd">        The sign-error LMS algorithm uses the sign of the error vector</span>
<span class="sd">        to change the filter coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                               <span class="o">*</span> <span class="n">psi_tmp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.normalized_least_mean_squares"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.normalized_least_mean_squares">[docs]</a>    <span class="k">def</span> <span class="nf">normalized_least_mean_squares</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Normalized Least Mean Squares filter.</span>

<span class="sd">        The normalization is used to avoid numerical instability when updating</span>
<span class="sd">        the estimated parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="p">(</span><span class="n">psi_tmp</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="o">+</span><span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi_tmp</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_normalized_sign_error"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_normalized_sign_error">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_normalized_sign_error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Normalized Sign-Error LMS filter.</span>

<span class="sd">        The normalization is used to avoid numerical instability when updating</span>
<span class="sd">        the estimated parameters and the sign of the error vector is used to</span>
<span class="sd">        to change the filter coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                               <span class="o">*</span> <span class="p">(</span><span class="n">psi_tmp</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="o">+</span><span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi_tmp</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_sign_regressor"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_sign_regressor">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_sign_regressor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the  Sign-Regressor LMS filter.</span>

<span class="sd">        The sign-regressor LMS algorithm uses the sign of the matrix</span>
<span class="sd">        information to change the filter coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_normalized_sign_regressor"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_normalized_sign_regressor">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_normalized_sign_regressor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Normalized Sign-Regressor LMS filter.</span>

<span class="sd">        The normalization is used to avoid numerical instability when updating</span>
<span class="sd">        the estimated parameters and the sign of the information matrix is</span>
<span class="sd">        used to change the filter coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">)</span>
                               <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eps</span> <span class="o">+</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi_tmp</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_sign_sign"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_sign_sign">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_sign_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the  Sign-Sign LMS filter.</span>

<span class="sd">        The sign-regressor LMS algorithm uses both the sign of the matrix</span>
<span class="sd">        information and the sign of the error vector to change the filter</span>
<span class="sd">        coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_normalized_sign_sign"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_normalized_sign_sign">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_normalized_sign_sign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Normalized Sign-Sign LMS filter.</span>

<span class="sd">        The normalization is used to avoid numerical instability when updating</span>
<span class="sd">        the estimated parameters and both the sign of the information matrix</span>
<span class="sd">        and the sign of the error vector are used to change the filter</span>
<span class="sd">        coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_mu</span>
                               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                               <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">psi_tmp</span><span class="p">)</span>
                               <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eps</span> <span class="o">+</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi_tmp</span><span class="p">)))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_normalized_leaky"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_normalized_leaky">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_normalized_leaky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the  Normalized Leaky LMS filter.</span>

<span class="sd">        When the leakage factor, gama, is set to 0 then there is no</span>
<span class="sd">        leakage in the estimation process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_gama</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="n">psi_tmp</span><span class="o">/</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_eps</span><span class="o">+</span><span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@psi_tmp</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_leaky"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_leaky">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_leaky</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the  Leaky LMS filter.</span>

<span class="sd">        When the leakage factor, gama, is set to 0 then there is no</span>
<span class="sd">        leakage in the estimation process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_gama</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="n">psi_tmp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_fourth"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_fourth">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_fourth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the  LMS Fourth filter.</span>

<span class="sd">        When the leakage factor, gama, is set to 0 then there is no</span>
<span class="sd">        leakage in the estimation process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Book: Hayes, M. H. (2009). Statistical digital signal processing</span>
<span class="sd">            and modeling. John Wiley &amp; Sons.</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Manuscript:Gui, G., Mehbodniya, A., &amp; Adachi, F. (2013).</span>
<span class="sd">            Least mean square/fourth algorithm with application to sparse</span>
<span class="sd">            channel estimation. arXiv preprint arXiv:1304.3911.</span>
<span class="sd">            &lt;https://arxiv.org/pdf/1304.3911.pdf&gt;`_</span>
<span class="sd">        [4]`Manuscript: Nascimento, V. H., &amp; Bermudez, J. C. M. (2005, March).</span>
<span class="sd">            When is the least-mean fourth algorithm mean-square stable?</span>
<span class="sd">            In Proceedings.(ICASSP&#39;05). IEEE International Conference on</span>
<span class="sd">            Acoustics, Speech, and Signal Processing, 2005.</span>
<span class="sd">            (Vol. 4, pp. iv-341). IEEE.</span>
<span class="sd">            &lt;http://www.lps.usp.br/vitor/artigos/icassp05.pdf&gt;`_</span>
<span class="sd">        [5]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="n">psi_tmp</span>
                               <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="Estimators.least_mean_squares_mixed_norm"><a class="viewcode-back" href="../../../code.html#sysidentpy.parameter_estimation.estimators.Estimators.least_mean_squares_mixed_norm">[docs]</a>    <span class="k">def</span> <span class="nf">least_mean_squares_mixed_norm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">psi</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parameter estimation using the Mixed-norm LMS filter.</span>

<span class="sd">        The weight factor controls the proportions of the error norms</span>
<span class="sd">        and offers an extra degree of freedom within the adaptation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        psi : ndarray of floats</span>
<span class="sd">            The information matrix of the model.</span>
<span class="sd">        y_train : array-like of shape = y_training</span>
<span class="sd">            The data used to training the model.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : array-like of shape = number_of_model_elements</span>
<span class="sd">            The estimated parameters of the model.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        A more in-depth documentation of all methods for parameters estimation</span>
<span class="sd">        will be available soon. For now, please refer to the mentioned</span>
<span class="sd">        references.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        [1]`Chambers, J. A., Tanrikulu, O., &amp; Constantinides, A. G. (1994).</span>
<span class="sd">            Least mean mixed-norm adaptive filtering.</span>
<span class="sd">            Electronics letters, 30(19), 1574-1575.</span>
<span class="sd">            &lt;https://ieeexplore.ieee.org/document/326382&gt;`_</span>
<span class="sd">        [2]`Dissertation (Portuguese): Zipf, J. G. F. (2011). Classificação,</span>
<span class="sd">            análise estatística e novas estratégias de algoritmos LMS de passo</span>
<span class="sd">            variável.</span>
<span class="sd">            &lt;https://repositorio.ufsc.br/bitstream/handle/123456789/94953/296734.pdf?sequence=1&gt;`_</span>
<span class="sd">        [3]`Wikipedia entry on Least Mean Squares</span>
<span class="sd">            &lt;https://en.wikipedia.org/wiki/Least_mean_squares_filter&gt;`_</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">y</span><span class="p">,</span> <span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_initial_values</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">psi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_theta</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="n">psi_tmp</span> <span class="o">=</span> <span class="n">psi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">psi_tmp</span><span class="o">.</span><span class="n">T</span><span class="nd">@theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">theta</span><span class="p">[:,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                               <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mu</span><span class="o">*</span><span class="n">psi_tmp</span>
                               <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                               <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_weight</span>
                                  <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_weight</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">xi</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">theta</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Wilson Rocha, Luan Pascoal, Samuel Oliveira, Samir Martins.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="../../../None"></script>
      <script type="text/javascript" src="../../../_static/jquery.fancybox.min.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
  <script type="text/javascript">
    $(function(){
      $('.image-reference').fancybox();
    })
  </script>

</body>
</html>